# STRIDE — Угрозы и контроли

| Поток/Элемент | Угроза (S/T/R/I/D/E) | Описание угрозы | Контроль | Ссылка на NFR | Проверка/Артефакт |
|---------------|-----------------------|------------------|----------|---------------|-------------------|
| F1            | S (Spoofing)          | Злоумышленник подбирает пароль пользователя. | Ограничение числа попыток входа. | NFR-06    | Интеграционный тест |
| F1            | I (Information Disclosure) | В случае ошибки сервер возвращает детальную информацию, которая помогает атакующему. | Стандартизированные и неинформативные сообщения об ошибках. | -             | Контрактные тесты |
| API (Элемент) | E (Elevation of Privilege) | Пользователь А получает доступ к карточкам пользователя Б через прямой запрос (`GET /cards/{id}`). | Проверка принадлежности карточки пользователю (owner-only) на уровне API. | NFR-03    | Интеграционные тесты на авторизацию |
| F4            | E (Elevation of Privilege) | SQL-инъекция через параметры запроса, позволяющая обойти логику и получить доступ ко всем данным в БД. | Использование параметризованных запросов (ORM). | -             | SAST-сканер |
| F7            | T (Tampering)         | Пользователь перемещает карточку в несуществующую колонку, что может вызвать ошибку или повредить данные. | Валидация входных данных (ID колонки) по известному списку. | NFR-04    | E2E-тесты, unit-тесты |
| F3            | T (Tampering)         | Злоумышленник внедряет вредоносный JS-код в название или описание карточки (XSS). | Очистка всех пользовательских данных на входе. | NFR-08    | Unit-тесты для sanitizer'а |
| F2            | I (Information Disclosure) | JWT-токен перехвачен и используется злоумышленником для доступа к системе от имени пользователя. | Короткое время жизни токена (TTL) + механизм отзыва (refresh tokens). | NFR-05    | Unit-тест на `exp` claim |
| API (Элемент) | D (Denial of Service) | Злоумышленник отправляет большое количество запросов на ресурсоемкие эндпоинты (например, `GET /cards`). | Rate-limiting на уровне API-шлюза или middleware. | NFR-02    | Нагрузочный тест |
| DB (Элемент)  | I (Information Disclosure) | Пароли пользователей украдены из БД в результате утечки и могут быть расшифрованы. | Хэширование паролей с использованием стойкого алгоритма (Argon2id). | NFR-01    | Unit-тест на функцию хэширования |
| API (Элемент) | R (Repudiation)       | Пользователь отрицает, что удалил важную карточку, а доказать обратное невозможно. | Ведение аудиторских логов для критичных операций (создание, удаление, перемещение). | -             | Проверка наличия логов в CI |
